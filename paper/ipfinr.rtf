{\rtf1\ansi\uc1\deff13\deflang1024
{\fonttbl{\f0\fnil\fcharset0 Zapf Chancery;}
{\f1\fnil\fcharset204 Zapf Chancery;}
{\f2\fnil\fcharset204 Times;}
{\f3\fnil\fcharset204 Helvetica;}
{\f4\fnil\fcharset204 Helvetica;}
{\f5\fnil\fcharset204 Courier;}
{\f6\fnil\fcharset2 Symbol;}
{\f7\fnil\fcharset0 MT Extra;}
{\f8\fnil\fcharset238 Zapf Chancery;}
{\f9\fnil\fcharset238 Times;}
{\f10\fnil\fcharset238 Helvetica;}
{\f11\fnil\fcharset238 Helvetica;}
{\f12\fnil\fcharset238 Courier;}
{\f13\fnil\fcharset0 Times;}
{\f14\fnil\fcharset0 Helvetica;}
{\f15\fnil\fcharset0 Helvetica;}
{\f16\fnil\fcharset0 Courier;}
}
{\colortbl;
\red0\green0\blue0;
\red0\green0\blue255;
\red0\green255\blue255;
\red0\green255\blue0;
\red255\green0\blue255;
\red255\green0\blue0;
\red255\green255\blue0;
\red255\green255\blue255;
\red0\green0\blue128;
\red0\green128\blue128;
\red0\green128\blue0;
\red128\green0\blue128;
\red128\green0\blue0;
\red128\green128\blue0;
\red128\green128\blue128;
\red192\green192\blue192;
}
{\stylesheet
{\s0\fs20\snext0 Normal;}
{\s2\ql\sb240\sa60\keepn\f13\b\fs40 \sbasedon0\snext0 heading 1;}
{\s2\ql\sb240\sa60\keepn\f13\b\fs40\li0 \sbasedon0\snext0 heading 1;}
{\s1\ql\sb240\sa60\keepn\f13\b\fs40\li0 \sbasedon0\snext0 heading 1;}
{\s6\ql\sb240\sa60\keepn\f13\b\fs24\li2048 \sbasedon0\snext0 heading 5;}
{\s3\ql\sb240\sa60\keepn\f13\b\fs32\li512 \sbasedon0\snext0 heading 2;}
{\s7\ql\sb240\sa60\keepn\f13\b\fs24\li2560 \sbasedon0\snext0 heading 6;}
{\s4\ql\sb240\sa60\keepn\f13\b\fs32\li1024 \sbasedon0\snext0 heading 3;}
{\s5\ql\sb240\sa60\keepn\f13\b\fs24\li1536 \sbasedon0\snext0 heading 4;}
{\s6\ql\sb240\sa60\keepn\f13\b\fs24 \sbasedon0\snext0 heading 5;}
{\s1\qc\sb240\sa60\keepn\f13\b\fs40 \sbasedon0\snext0 part;}
{\s3\ql\sb240\sa60\keepn\f13\b\fs32 \sbasedon0\snext0 heading 2;}
{\s7\ql\sb240\sa60\keepn\f13\b\fs24 \sbasedon0\snext0 heading 6;}
{\s4\ql\sb240\sa60\keepn\f13\b\fs32 \sbasedon0\snext0 heading 3;}
{\s5\ql\sb240\sa60\keepn\f13\b\fs24 \sbasedon0\snext0 heading 4;}
}
{\info
{\title Original file was ipfinr.tex}
{\doccomm Created using latex2rtf 1.9.19 (released Nov 20 2007) on Sat Mar 15 11:01:58 2014
}
}
{\footer\pard\plain\f13\fs20\qc\chpgn\par}
\paperw11960\paperh16900\margl1300\margr1300\margt1300\margb1300\pgnstart0\widowctrl\qj\ftnbj\f13\aftnnar
{
\par\pard\qc {\fs30 \pard\qc\sl240\slmult1 \fi300 The performance of Iterative Proportional Fitting for spatial microsimulation: applying new tests to an old technique}
\par\pard\qc {\fs24 Robin Lovelace}
\par\pard\qc {\fs24 }
\par\pard\qc {\fs24 }
\par\pard\qc {\fs24 }\par
{\pard\qj\sl240\slmult1 \fi0 \qc{\b Abstract}\par
\pard\qj\sl240\slmult1 \li1024\ri1024\fi0 Iterative Proportional Fitting (IPF), also known as biproportional fitting or the RAS algorithm, is an established technique in Regional Science and has been used for a variety of purposes in the field. Primary amongst these has been the generation of small area microdata. The technique is mature, widely used and relatively straight-forward yet there have been few studies focused on evaluation of its performance. An additional research problem is the tendency of researchers to \lquote start from scratch\rquote , resulting in a variety ad-hock implementations, with little evidence about the relative merits of differing approaches. Although IPF is well described mathematically, reproducible examples of the algorithm, written in modern programming languages, are rare in the academic literature. These knowledge gaps mean that answers to methodological questions must be guessed: Under what conditions can conversion be expected?  How many iterations should be used for any given application?  And what are the impacts of initial weights and integerisation on the final result?  This paper tackles such questions, using a systematic methodology based on publicly available code and input data. The results confirm IPF\rquote s status as robust and widely applicable method for combining areal and individual-level data and demonstrate the importance of using various metrics of for determining its performance. We conclude with an agenda for future tests and offer more general guidance on how the method can be optimised to maximise its utility for future research.\par
\pard\qj\sl240\slmult1 \li1024\ri1024\fi300 Keywords: Iterative proportional fitting, spatial microsimulation, modelling\par
\pard\qj\sl240\slmult1 \li1024\ri1024\fi300 JEL Code: C \par
}\pard\qj\sl240\slmult1 \sb360 \fi0 {\s3\ql\sb240\sa60\keepn\f13\b\fs32 1  Notes for authors\par
}\pard\qj\sl240\slmult1 \sb60 \fi0 Additonal papers to cite include: {\par
\pard\qj\sl240\slmult1 \sb50 \li600\fi-300 \bullet\tab {Harland et\~al.} (2012) \par
\pard\qj\sl240\slmult1 \sb50 \li600\fi-300 \bullet\tab {Smith et\~al.} (2009) \par
\pard\qj\sl240\slmult1 \sb50 \li600\fi-300 \bullet\tab {Cullinan} (2010) \par
\pard\qj\sl240\slmult1 \sb50 \li600\fi-300 \bullet\tab \par
}\pard\qj\sl240\slmult1 \sb300 \fi0 {\s3\ql\sb240\sa60\keepn\f13\b\fs32 2  Introduction\par
}\pard\qj\sl240\slmult1 \sb60 \fi0 The aggregation of survey data has a long history in the social sciences. Generally this involves translating raw data from a \lquote long\rquote  format \emdash  the usual format of raw census data as it is digitised and entered into a database, where each row represents an individual and each column a separate variable \emdash  to a \lquote wide\rquote  data format ({Van Buuren}, 2012, Chapter 9). The wide data form, where each row represents a geographic area or other sub-group of the total population and each column represents a variable value or bin (see {fmsim-schema}), generally occupies less disk space for storage but has some important disadvantages. Data loss usually occurs when georeferenced individual level survey data \emdash  {\i spatial microdata} \emdash  is aggregated into the wide form, especially when continuous variables are converted into discrete categories and when not cross-tabulations, such as age/income, are not provided. The process of aggregation is performed in three steps: {\par
\pard\qj\sl240\slmult1 \sb50 \li600\fi-300 1.\tab conversion of all variables into discrete categories (e.g.\~an individual with an income of \u163?13,000 per year would be allocated to band of \u163?10,000 to \u163?15,000 per year) \par
\pard\qj\sl240\slmult1 \sb50 \li600\fi-300 2.\tab assignment of a column to each unique category \par
\pard\qj\sl240\slmult1 \sb50 \li600\fi-300 3.\tab assignment of integer counts to cells in each column to represent the number of people with each characteristic. \par
}\pard\qj\sl240\slmult1 \sb60 \fi0 Frequently, large national social survey datasets such as censuses are {\i only} available in the wide, geographically aggregated form. This is problematic for the analysis of spatial phenomena ({Openshaw}, 1984; {Lee}, 2009). It is from this context of common forms of geographical data storage formats that this paper departs.\par
\pard\qj\sl240\slmult1 \fi300 Iterative proportional fitting (IPF) can help overcome the limitations of wide, geographically aggregated data sources when used in {\i spatial microsimulation}. In simplistic terms IPF can be understood as the reversal of geographic aggregation described in points 1\endash 3 above, to approximate the original \lquote long\rquote  dataset ({fmsim-schema}). Thus the need for spatial microsimulation is driven by the tendency of statistical agencies to make the raw georeferenced microdata generated by large social surveys unavailable to the research community ({Lee}, 2009). In fact spatial microsimulation, the term favoured by geographers and regional scientists, is generally known as {\i population synthesis} in transport modelling, which is and apt name: its core function is to simulate populations based on imperfect data. Spatial microsimulation can also refer to a wider approach which harnesses spatial microdata in the analysis stage ({Clarke and Holm}, 1987; {Lovelace et\~al.}, 2014). In this paper we focus on the former meaning, which is also known as {\i static spatial microsimulation} ({Ballas et\~al.}, 2005).\par
{\pard\qj\sl240\slmult1 \sb240 \fi300 {\par
\pard\qc\sl240\slmult1 \fi0  \par
}\pard\qc\sl240\slmult1 \fi0 {Figure {\*\bkmkstart BMfmsim_schema}1{\*\bkmkend BMfmsim_schema}: Schema of iterative proportional fitting (IPF) and combinatorial optimisation in the wider context of the availability of different data formats and spatial microsimulation. }{\field{\*\fldinst TC "1 Schema of iterative proportional fitting (IPF) and combinatorial optimisation in the wider context of the availability of different data formats and spatial microsimulation. " \\f f}{\fldrslt }}\par
}\pard\qj\sl240\slmult1 \sb360 \fi0 {\s4\ql\sb240\sa60\keepn\f13\b\fs32 2.1  What is IPF and why use it? \par
}\pard\qj\sl240\slmult1 \sb60 \fi0 IPF is a statistical procedure that enables the calculation of {\i maximum likelihood} of cell values that are constrained by multiple marginal totals. Some confusion surrounds the procedure because it has multiple names: the \lquote RAS algorithm\rquote , \lquote biproportional fitting\rquote  and to a lesser extent \lquote raking\rquote  have all been used to describe the procedure at different times and in different branches of academic research ({Lahr and de\~Mesnard}, 2004). \lquote Entropy maximisation\rquote  is a related technique, of which IPF is considered to be a subset ({Johnston and Pattie}, 1993; {Rich and Mulalic}, 2012).{\up16\chftn}
{\*\footnote \pard\plain\s246\f13\fs20 {\up16\chftn}As an aside, IPF is considered by {Rich and Mulalic} (2012) to be a particular efficient for of entropy maximisation: \ldblquote The popularity of the IPF is therefore mainly due to the fact that it provides a solution which is equivalent to that of the ME approaches, but attained in a much more computationally efficient way\rdblquote  (p.\~469). }
 Usage characteristics of these different terms are summarised in {tterms}.\par
{\pard\qj\sl240\slmult1 \sb240 \fi0  \par
\pard\qc\sl240\slmult1 \fi0 {Table {\*\bkmkstart BMtterms}1{\*\bkmkend BMtterms}: Usage characteristics of different terms for the IPF procedure, from the Scopus database}{\field{\*\fldinst TC "1 Usage characteristics of different terms for the IPF procedure, from the Scopus database" \\f t}{\fldrslt }}\par
{\pard\qj\sl240\slmult1 \fi0 \par
\trowd\cellx3450\cellx6900\cellx10350\cellx13800\cellx17250
\pard\intbl\ql {Search term}\cell
\pard\intbl\ql {N. citations}\cell
\pard\intbl\q{Commonest subject area}\cell
\pard\intbl\q{% Since 2010}\cell
\pard\intbl\q{% Mentioning \ldblquote regional\rdblquote }\cell
\row
\trowd\cellx3450\cellx6900\cellx10350\cellx13800\cellx17250
\pard\intbl\ql {Entropy maximisation}\cell
\pard\intbl\ql {564}\cell
\pard\intbl\q{Engineering}\cell
\pard\intbl\q{30}\cell
\pard\intbl\q{9}\cell
\row
\trowd\cellx3450\cellx6900\cellx10350\cellx13800\cellx17250
\pard\intbl\ql {\ldblquote Iterative proportional fitting\rdblquote }\cell
\pard\intbl\ql {135}\cell
\pard\intbl\q{Mathematics}\cell
\pard\intbl\q{22}\cell
\pard\intbl\q{16}\cell
\row
\trowd\cellx3450\cellx6900\cellx10350\cellx13800\cellx17250
\pard\intbl\ql {\ldblquote RAS Algorithm\rdblquote }\cell
\pard\intbl\ql {25}\cell
\pard\intbl\q{Comp. science}\cell
\pard\intbl\q{24}\cell
\pard\intbl\q{24}\cell
\row
\trowd\cellx3450\cellx6900\cellx10350\cellx13800\cellx17250
\pard\intbl\ql {\ldblquote Iterative proportional scaling\rdblquote }\cell
\pard\intbl\ql {15}\cell
\pard\intbl\q{Mathematics}\cell
\pard\intbl\q{27}\cell
\pard\intbl\q{0}\cell
\row
\trowd\cellx3450\cellx6900\cellx10350\cellx13800\cellx17250
\pard\intbl\ql {Matrix raking}\cell
\pard\intbl\ql {12}\cell
\pard\intbl\q{Engineering}\cell
\pard\intbl\q{50}\cell
\pard\intbl\q{0}\cell
\row
\trowd\cellx3450\cellx6900\cellx10350\cellx13800\cellx17250
\pard\intbl\ql {Biproportional estimation}\cell
\pard\intbl\ql {12}\cell
\pard\intbl\q{Social sciences}\cell
\pard\intbl\q{17}\cell
\pard\intbl\q{33}\cell
\row
}  \par
}\pard\qj\sl240\slmult1 \sb240 \fi0 Ambiguity in terminology surrounding the procedure has existed for a long time: when Michael Bacharach began using the term \lquote biproportional\rquote  late 1960s, he did so with the following caveat: \ldblquote The \lquote biproportional\rquote  terminology is not introduced in what would certainly be a futile attempt to dislodge \lquote RAS\rquote , but to help to abstract the mathematical characteristics from the economic associations of the model\rdblquote  ({Bacharach}, 1970). The original formulation of the procedure is generally ascribed to {Deming} (1940), who presented an iterative procedure for solving the problem of how to modify internal cell counts of census data in \lquote wide\rquote  form, based on new marginal totals. Without repeating the rather involved mathematics of this discovery, it is worth quoting again from {Bacharach} (1970), who provided as clear a description as any of the procedure in plain English: \ldblquote The method that Deming and Stephan suggested for computing a solution was to fit rows to the known row sums and columns to the known column sums by alternate [iterative] scalar multiplications of rows and columns of the base matrix\rdblquote  (p.\~4). The main purpose for revisiting and further developing the technique from Bacharach\rquote s perspective was to provide forecasts of the sectoral disaggregation of economic growth models for the British government. It was not until later (e.g.\~{Clarke and Holm}, 1987) that the procedure was rediscovered for geographic research.\par
\pard\qj\sl240\slmult1 \fi300 Thus IPF is a general purpose tool with multiple uses. In this paper we focus on its ability to {\i disaggregate} the geographically aggregated data typically provided by national statistical agencies to synthesis {\i spatial microdata}, as illustrated in {fmsim-schema}. But why would one want do this in the first place? \par
\pard\qj\sl240\slmult1 \fi300 To answer this question, let us briefly consider the advantages and drawbacks of the ubiquitous wide data format. The main advantages of wide datasets are that they can summarise information about very many individuals in a relatively few rows, saving storage space, easing the analysis and, critically for policy makers, ensuring the anonymity survey respondents. But the process of aggregation used to create wide data is almost always associated with data loss, leading to the following disadvantages: {\par
\pard\qj\sl240\slmult1 \sb50 \li600\fi-300 \bullet\tab {\i Binning of continuous variables:} we do not know from a wide dataset if the aforementioned person earning \'a313,000 is in fact on a salary of \'a310,000, \'a315,000 or anywhere in between \par
\pard\qj\sl240\slmult1 \sb50 \li600\fi-300 \bullet\tab {\i Loss of geographical resolution:} when aggregation is done by geographical zones spatial information is lost. Instead of knowing person\rquote s precise home location, from the full dataset, we may only be able to pin them down to a relatively large administrative area. \par
\pard\qj\sl240\slmult1 \sb50 \li600\fi-300 \bullet\tab {\i Loss of cross-tabulation}: during the process of aggregation the links between different variables, often expressed as \lquote contingency tables\rquote , is usually lost. For example a female cyclist will be represented as additional units in the \ldblquote cyclist\rdblquote  and \ldblquote female\rdblquote  categories, without knowledge of their interrelation. \par
}\pard\qj\sl240\slmult1 \sb60 \fi0 In the {\i physical sciences} both data formats are common and the original long dataset is generally available. In the social sciences, by contrast, the long format is often unavailable due to the long history of and confidentiality issues surrounding officially collected survey data. It is worth emphasising that National Census datasets \emdash  in which characteristics of every individual living in a state are recorded and which constitute some of the best datasets in social science \emdash  are usually only available in wide form. This poses major challenges to researchers in the sciences who interested in intra-zone variability at the local level ({Whitworth}, 2012; {Lee}, 2009).\par
\pard\qj\sl240\slmult1 \fi300 A related long-standing research problem especially prevalent in geography and regional science is the scale of analysis. There is often a trade-off between the quality and resolution of the data, which can result in a compromise between detail and accuracy of results ({Ballas and Clarke}, 2003). A common scenario facing researchers investigating a spatial problem is being presented with two datasets: one long aspatial survey table where each row represents the characteristics of an individual \emdash  such as age, sex, employment status and income \emdash  and another of wide, geographically aggregated dataset containing count data for each category. IPF solves this problem when used in spatial microsimulation by proportionally assigning individuals to zones of which they are most representative.\par
\pard\qj\sl240\slmult1 \sb120 \fi0 {\s4\ql\sb240\sa60\keepn\f13\b\fs32 2.2  IPF in spatial microsimulation\par
}\pard\qj\sl240\slmult1 \sb60 \fi0 Spatial microsimulation tackles the aforementioned problems associated with the prevalent geographically aggregated wide data form by simulating the individuals within each administrative zone. The most detailed output of this process of spatial microsimulation is \lquote spatial microdata\rquote , a long table of individuals with associated attributes and weights for each zone (see {t1} for a simple example). Because these individuals correspond to observations in the survey dataset, the spatial microdata generated in this way, of any size and complexity, can be stored with only 3 columns: person identification number (ID), zone and weight. Weights are critical to spatial microdata generated in this way, as they determine how representative each individual is of each zone. Thus, an even more compact way of storing spatial microdata taken from a single dataset is as a \lquote weight matrix\rquote  (table 2). \par
\pard\qj\sl240\slmult1 \fi300 Representing the data in this form offers a number of advantages (Clarke and Holm, 1987). These include: {\par
\pard\qj\sl240\slmult1 \sb50 \li600\fi-300 \bullet\tab The ability to investigate intra-zone variation (variation within each zone can be analysed by subsetting a single area from the data frame). \par
\pard\qj\sl240\slmult1 \sb50 \li600\fi-300 \bullet\tab Cross-tabulations can be created for any combination of variables (e.g. age and employment status). \par
\pard\qj\sl240\slmult1 \sb50 \li600\fi-300 \bullet\tab The presentation of continuous variables such as income as real numbers, rather than as categorical count data, in which there is always data loss. \par
\pard\qj\sl240\slmult1 \sb50 \li600\fi-300 \bullet\tab The data is in a form that is ready to be passed into an individual-level model. For example individual behaviour could simulate traffic, migration or the geographical distribution of future demand for healthcare. \par
}\pard\qj\sl240\slmult1 \sb60 \fi0 These benefits have not gone unnoticed by the spatial modelling community. Spatial microsimulation is now more than a methodology, and can be considered as a research field in its own right, with a growing body of literature, methods and results ({Tanton and Edwards}, 2013). In tandem with these methodological developments, a growing number of applied studies has emerged to take advantage of the new possibilities opened up by such small area individual-level data, with applications as diverse as the location of health services ({Tomintz et\~al.}, 2008) to the analysis of commuting ({Lovelace et\~al.}, 2014). Various strategies for generating small area microdata are available, as described in recent overviews on the subject ({Tanton and Edwards}, 2013; {Ballas et\~al.}, 2013; {Hermes and Poulsen}, 2012). However, it is not always clear which one is most appropriate. There has been work testing ({Jirou\u353sek and Preu\u269cil}, 1995) and improving ({Teh and Welling}, 2003) in abstract terms, but research focused on testing use the algorithm for spatial microsimulation. This research gap is highlighted in the conclusions of a recent Reference Guide to spatial microsimulation ({Clarke and Harding}, 2013, p\~270): \ldblquote It would be desirable if the spatial microsimulation community were able to continue to analyse which of the various reweighting/synthetic reconstruction techniques is most accurate \emdash  or to identify whether one approach is superior for some applications while another approach is to be preferred for other applications\rdblquote . This paper rises to this challenge by systematically testing the IPF algorithm for spatial microsimulation. Before proceeding to the model experiments, we first provide a brief overview of the applications of IPF in regional science and outline the theory underlying the procedure based on a simple example. \par
\pard\qj\sl240\slmult1 \sb120 \fi0 {\s4\ql\sb240\sa60\keepn\f13\b\fs32 2.3  Applications\par
}{\b \pard\qj\sl240\slmult1 \sb60 \fi0 Dimitris and Eveline: please fill in this section} Applications of IPF include using it ...\par
\pard\qj\sl240\slmult1 \fi300 The application of greatest interest to regional scientists is as a method of spatial microsimulation: generating individual level data allocated to specific zones... Papers that have used IPF in this context (or a substitutable method such as simulated annealing) have explored a range of regional economic problems that purely aggregate level analyses struggle to address. These include: {\par
\pard\qj\sl240\slmult1 \sb50 \li600\fi-300 \bullet\tab using spatial microdata to analyses the wider impacts of major job losses at the local level ({Ballas et\~al.}, 2006). \par
\pard\qj\sl240\slmult1 \sb50 \li600\fi-300 \bullet\tab an investigation into to local impacts of the marine sector in Ireland ({Morrissey et\~al.}, 2013) \par
\pard\qj\sl240\slmult1 \sb50 \li600\fi-300 \bullet\tab ... \par
\pard\qj\sl240\slmult1 \sb50 \li600\fi-300 \bullet\tab ... \par
}\pard\qj\sl240\slmult1 \sb300 \fi0 {\s3\ql\sb240\sa60\keepn\f13\b\fs32 {\*\bkmkstart BMs_theory}3{\*\bkmkend BMs_theory}  The IPF algorithm: a worked example\par
}\pard\qj\sl240\slmult1 \sb60 \fi0 In many modelling texts there is a precedence of theory over application: the latter usually flows from the former. As outlined in the previous section, the mathematics underlying IPF have been thoroughly demonstrated in research stemming back to the 1940s, yet {\i practical} demonstrations, focused on making algorithm as accessible as possible to others, is lacking. {Norman} (1999) and and xxx exemplify their work with code snippets from an implementation of IPF in the proprietary software SPSS and reference to an Excel macro that is available on request, respectively. {Williamson} (2007) also represents good practice in this regard, with a manual for running combinatorial optimisation algorithms described in previous work. ({Ballas et\~al.}, 2005) demonstrates IPF with a worked example to be calculated using mental arithmetic, but does not progress to illustrate how the examples are then implemented in computer code.\par
\pard\qj\sl240\slmult1 \fi300 It is worth restating that IPF is a simple statistical procedure, \ldblquote in which cell counts in a contingency table containing the sample observations are scaled to be consistent with various externally given population marginals\rdblquote  ({McFadden et\~al.}, 2006). In other words, and in the context of {\i spatial} microsimulation, IPF produces maximum likelihood estimates for the frequency with which people appear in different areas.\par
\pard\qj\sl240\slmult1 \fi300 To illustrate how IPF works in practice, a simplified example is described below. This is a modified version of a simpler demonstration from {Ballas et\~al.} (2005).{\up16\chftn}
{\*\footnote \pard\plain\s246\f13\fs20 {\up16\chftn}In {Ballas et\~al.} (2005) the interaction between the age and sex constraints are assumed to be known. (Their equivalent of {t:s2} contains data for every cell, not question marks.) This results in IPF converging instantly. However, in Census data, such cross-tabulation is often absent, and IPF must converge over multiple constraints and iterations. This latter scenario is assumed in the worked example below. Other worked examples of the principles are provided in {Johnston} (1985, Appendix 3) (for entropy maximisation), {Norman} (1999) and {Simpson and Tranmer} (2005) (using the proprietary statistical software SPSS). }
 Table {\field{\*\fldinst{\lang1024 REF BMt_w \\* MERGEFORMAT }}{\fldrslt{[table][2][]2}}} describes a hypothetical microdataset comprising 5 individuals, who are defined by two constraint variables, age and sex. Each has two categories. Table {\field{\*\fldinst{\lang1024 REF BMt_s \\* MERGEFORMAT }}{\fldrslt{[table][3][]3}}} contains aggregated data for a hypothetical area, as it would be downloaded from census dissemination portal Casweb. {t:s2} illustrates this table in a different form, which shows our ignorance of interaction between age and sex.\par
{\pard\qj\sl240\slmult1 \sb240 \fi0  \par
\pard\qc\sl240\slmult1 \fi0 {Table {\*\bkmkstart BMt_w}2{\*\bkmkend BMt_w}: A hypothetical input microdata set (the original weights set to one). The bold value is used subsequently for illustrative purposes.}{\field{\*\fldinst TC "2 A hypothetical input microdata set (the original weights set to one). The bold value is used subsequently for illustrative purposes." \\f t}{\fldrslt }}\par
{\pard\qc\sl240\slmult1 \fi0 \par
\trowd\cellx1725\cellx3450\cellx5175\cellx6900
\pard\intbl\ql {{Individual }}\cell
\pard\intbl\ql {{Sex}}\cell
\pard\intbl\ql {{Age-group}}\cell
\pard\intbl\ql {{Weight}}\cell
\row
\trowd\cellx1725\cellx3450\cellx5175\cellx6900
\pard\intbl\ql {1}\cell
\pard\intbl\ql {Male}\cell
\pard\intbl\ql {Over-50}\cell
\pard\intbl\ql {1}\cell
\row
\trowd\cellx1725\cellx3450\cellx5175\cellx6900
\pard\intbl\ql {2}\cell
\pard\intbl\ql {Male}\cell
\pard\intbl\ql {Over-50}\cell
\pard\intbl\ql {1}\cell
\row
\trowd\cellx1725\cellx3450\cellx5175\cellx6900
\pard\intbl\ql {3}\cell
\pard\intbl\ql {{Male}}\cell
\pard\intbl\ql {{Under-50}}\cell
\pard\intbl\ql {{\b 1}}\cell
\row
\trowd\cellx1725\cellx3450\cellx5175\cellx6900
\pard\intbl\ql {4}\cell
\pard\intbl\ql {Female}\cell
\pard\intbl\ql {Over-50}\cell
\pard\intbl\ql {1}\cell
\row
\trowd\cellx1725\cellx3450\cellx5175\cellx6900
\pard\intbl\ql {5}\cell
\pard\intbl\ql {Female}\cell
\pard\intbl\ql {Under-50}\cell
\pard\intbl\ql {1}\cell
\row
}  \par
}{\pard\qj\sl240\slmult1 \sb1049 \fi0  \par
\pard\qc\sl240\slmult1 \fi0 {Table {\*\bkmkstart BMt_s}3{\*\bkmkend BMt_s}: Hypothetical small area constraints data ({{{\i s}}}).}{\field{\*\fldinst TC "3 Hypothetical small area constraints data ({{{\i s}}})." \\f t}{\fldrslt }}\par
{\pard\qc\sl240\slmult1 \fi0 \par
\trowd\cellx1380\clmgf\cellx2760\clmrg\cellx4140\clmgf\cellx5520\clmrg\cellx6900
\pard\intbl\qc {Constraint {{{\f6\'DE}}}}\cell
\pard\intbl\qc {{{{\i i}}}}\cell
\pard\intbl{}\cell
\pard\intbl\qc {{{{\i j}}}}\cell
\pard\intbl{}\cell
\row
\trowd\cellx1380\cellx2760\cellx4140\cellx5520\cellx6900
\pard\intbl\qc {Category {{{\f6\'DE}}}}\cell
\pard\intbl\ql {{{\field{\*\fldinst{ EQ {{\i i}\\s\\do5({\fs16 1})}}}{\fldrslt }}}}\cell
\pard\intbl\ql {{{\field{\*\fldinst{ EQ {{\i i}\\s\\do5({\fs16 2})}}}{\fldrslt }}}}\cell
\pard\intbl\ql {{{\field{\*\fldinst{ EQ {{\i j}\\s\\do5({\fs16 1})}}}{\fldrslt }}}}\cell
\pard\intbl\ql {{{\field{\*\fldinst{ EQ {{\i j}\\s\\do5({\fs16 2})}}}{\fldrslt }}}}\cell
\row
\trowd\cellx1380\cellx2760\cellx4140\cellx5520\cellx6900
\pard\intbl\qc {Area {{{\f6\'DF}}}}\cell
\pard\intbl\ql {Under-50}\cell
\pard\intbl\ql {Over-50}\cell
\pard\intbl\ql {Male}\cell
\pard\intbl\ql {Female}\cell
\row
\trowd\cellx1380\cellx2760\cellx4140\cellx5520\cellx6900
\pard\intbl\qc {1}\cell
\pard\intbl\ql {8}\cell
\pard\intbl\ql {4}\cell
\pard\intbl\ql {6}\cell
\pard\intbl\ql {6}\cell
\row
}  \par
}{\pard\qj\sl240\slmult1 \sb1049 \fi0  \par
\pard\qc\sl240\slmult1 \fi0 {Table {\*\bkmkstart BMt_s2}4{\*\bkmkend BMt_s2}: Small area constraints expressed as marginal totals, and the cell values to be estimated.}{\field{\*\fldinst TC "4 Small area constraints expressed as marginal totals, and the cell values to be estimated." \\f t}{\fldrslt }}\par
{\pard\qc\sl240\slmult1 \fi0 \par
\trowd\cellx1380\cellx2760\clmgf\cellx4140\clmrg\cellx5520\cellx6900
\pard\intbl\qc {Marginal totals}\cell
\pard\intbl\ql {}\cell
\pard\intbl\qc {{{{\i j}}}}\cell
\pard\intbl{}\cell
\pard\intbl\ql {}\cell
\row
\trowd\cellx1380\cellx2760\cellx4140\cellx5520\cellx6900
\pard\intbl\qc {}\cell
\pard\intbl\ql {Age/sex}\cell
\pard\intbl\ql {Male}\cell
\pard\intbl\ql {Female}\cell
\pard\intbl\ql {T}\cell
\row
\trowd\cellx1380\cellx2760\cellx4140\cellx5520\cellx6900
\pard\intbl\qc {{2}{*}{{{{\i i}}}}}\cell
\pard\intbl\ql {Under-50}\cell
\pard\intbl\ql {{\b ? }}\cell
\pard\intbl\ql {? }\cell
\pard\intbl\ql {8}\cell
\row
\trowd\cellx1380\cellx2760\cellx4140\cellx5520\cellx6900
\pard\intbl\qc {}\cell
\pard\intbl\ql {Over-50}\cell
\pard\intbl\ql {? }\cell
\pard\intbl\ql {? }\cell
\pard\intbl\ql {4}\cell
\row
\trowd\cellx1380\cellx2760\cellx4140\cellx5520\cellx6900
\pard\intbl\qc {}\cell
\pard\intbl\ql {T}\cell
\pard\intbl\ql {6}\cell
\pard\intbl\ql {6}\cell
\pard\intbl\ql {12}\cell
\row
}  \par
}\pard\qj\sl240\slmult1 \sb240 \fi0 Table {\field{\*\fldinst{\lang1024 REF BMt_m \\* MERGEFORMAT }}{\fldrslt{[table][5][]5}}} presents the hypothetical microdata in aggregated form, that can be compared directly to Table {\field{\*\fldinst{\lang1024 REF BMt_s2 \\* MERGEFORMAT }}{\fldrslt{[table][4][]4}}}.\par
{\pard\qj\sl240\slmult1 \sb240 \fi0  \par
\pard\qc\sl240\slmult1 \fi0 {Table {\*\bkmkstart BMt_m}5{\*\bkmkend BMt_m}: The aggregated results of the weighted microdata set ({{{\i m}(1)}}). Note, these values depend on the weights allocated in Table {\field{\*\fldinst{\lang1024 REF BMt_w \\* MERGEFORMAT }}{\fldrslt{[table][2][]2}}} and therefore change after each iteration}{\field{\*\fldinst TC "5 The aggregated results of the weighted microdata set ({{{\i m}(1)}}). Note, these values depend on the weights allocated in Table {\field{\*\fldinst{\lang1024 REF BMt_w \\* MERGEFORMAT }}{\fldrslt{[table][2][]2}}} and therefore change after each iteration" \\f t}{\fldrslt }}\par
{\pard\qc\sl240\slmult1 \fi0 \par
\trowd\cellx1380\cellx2760\clmgf\cellx4140\clmrg\cellx5520\cellx6900
\pard\intbl\qc {Marginal totals}\cell
\pard\intbl\ql {}\cell
\pard\intbl\qc {{{{\i j}}}}\cell
\pard\intbl{}\cell
\pard\intbl\ql {}\cell
\row
\trowd\cellx1380\cellx2760\cellx4140\cellx5520\cellx6900
\pard\intbl\qc {}\cell
\pard\intbl\ql {Age/sex}\cell
\pard\intbl\ql {Male}\cell
\pard\intbl\ql {Female}\cell
\pard\intbl\ql {T}\cell
\row
\trowd\cellx1380\cellx2760\cellx4140\cellx5520\cellx6900
\pard\intbl\qc {{2}{*}{{{{\i i}}}}}\cell
\pard\intbl\ql {Under-50}\cell
\pard\intbl\ql {{\b 1}}\cell
\pard\intbl\ql {1}\cell
\pard\intbl\ql {2}\cell
\row
\trowd\cellx1380\cellx2760\cellx4140\cellx5520\cellx6900
\pard\intbl\qc {}\cell
\pard\intbl\ql {Over-50}\cell
\pard\intbl\ql {2}\cell
\pard\intbl\ql {1}\cell
\pard\intbl\ql {3}\cell
\row
\trowd\cellx1380\cellx2760\cellx4140\cellx5520\cellx6900
\pard\intbl\qc {}\cell
\pard\intbl\ql {T}\cell
\pard\intbl\ql {3}\cell
\pard\intbl\ql {2}\cell
\pard\intbl\ql {5}\cell
\row
}  \par
}\pard\qj\sl240\slmult1 \sb240 \fi0 Using these data it is possible to readjust the weights of the hypothetical individuals, so that their sum would add up to the totals given in Table {\field{\*\fldinst{\lang1024 REF BMt_s2 \\* MERGEFORMAT }}{\fldrslt{[table][4][]4}}} (12). In particular, the weights can be readjusted by multiplying them by the marginal totals, originally taken from Table {\field{\*\fldinst{\lang1024 REF BMt_s \\* MERGEFORMAT }}{\fldrslt{[table][3][]3}}} and then divided by the respective marginal total in {\field{\*\fldinst{\lang1024 REF BMt_m \\* MERGEFORMAT }}{\fldrslt{[table][5][]5}}}. Because the total for each small-area constraint is 12, this must be done one constraint at a time. This can be expressed, for a given area and a given constraint ({{{\i i}}} or age in this case), as follows:\par
{\par\par
\pard\tqc\tx3450\tqr\tx6900\tab {\field{\*\fldinst{ EQ {{\i w}({\i n}+1)\\s\\do5({\fs16 {\i i}{\i j}})= \\F({\i w}({\i n})\\s\\do5({\fs16 {\i i}{\i j}}){\f6\u-3916\'B4}{\i s}{\i T}\\s\\do5({\fs16 {\i i}}),{\i m}{\i T}({\i n})\\s\\do5({\fs16 {\i i}}))}}}{\fldrslt }}\tab{\b0 ({\*\bkmkstart BMeq_ipf}1{\*\bkmkend BMeq_ipf})}\par
}\pard\qj\sl240\slmult1 \fi0 where {{\field{\*\fldinst{ EQ {{\i w}({\i n}+1)\\s\\do5({\fs16 {\i i}{\i j}})}}}{\fldrslt }}} is the new weight for individuals with characteristics {{{\i i}}} (age, in this case), and {{{\i j}}} (sex), {{\field{\*\fldinst{ EQ {{\i w}({\i n})\\s\\do5({\fs16 {\i i}{\i j}})}}}{\fldrslt }}} is the original weight for individuals with these characteristics, {{\field{\*\fldinst{ EQ {{\i s}{\i T}\\s\\do5({\fs16 {\i i}})}}}{\fldrslt }}} is element marginal total of the small area constraint, {{{\i s}}} (Table {\field{\*\fldinst{\lang1024 REF BMt_s \\* MERGEFORMAT }}{\fldrslt{[table][3][]3}}}) and {{\field{\*\fldinst{ EQ {{\i m}{\i T}({\i n})\\s\\do5({\fs16 {\i i}})}}}{\fldrslt }}} is the marginal total of category {{{\i j}}} of the aggregated results of the weighted microdata, {{{\i m}}} (Table {\field{\*\fldinst{\lang1024 REF BMt_m \\* MERGEFORMAT }}{\fldrslt{[table][5][]5}}}). {{{\i n}}} represents the iteration number. Although the marginal totals of {{{\i s}}} are known, its cell values are unknown. Thus, IPF estimates the interaction (or cross-tabulation) between constraint variables. (Follow the emboldened values in the tables to see how the new weight of individual 3 is calculated for the sex constraint.) Table {\field{\*\fldinst{\lang1024 REF BMt_new_weights \\* MERGEFORMAT }}{\fldrslt{[table][6][]6}}} illustrates the weights that result. Notice that the sum of the weights is equal to the total population, from the constraint variables.\par
{\pard\qj\sl240\slmult1 \sb240 \fi0  \par
\pard\qc\sl240\slmult1 \fi0 {Table {\*\bkmkstart BMt_new_weights}6{\*\bkmkend BMt_new_weights}: Reweighting the hypothetical microdataset in order to fit Table {\field{\*\fldinst{\lang1024 REF BMt_s \\* MERGEFORMAT }}{\fldrslt{[table][3][]3}}}.}{\field{\*\fldinst TC "6 Reweighting the hypothetical microdataset in order to fit Table {\field{\*\fldinst{\lang1024 REF BMt_s \\* MERGEFORMAT }}{\fldrslt{[table][3][]3}}}." \\f t}{\fldrslt }}\par
{\pard\qc\sl240\slmult1 \fi0 \par
\trowd\cellx1380\cellx2760\cellx4140\cellx5520\cellx6900
\pard\intbl\ql {{Individual}}\cell
\pard\intbl\ql {{Sex}}\cell
\pard\intbl\ql {{age-group}}\cell
\pard\intbl\ql {{Weight}}\cell
\pard\intbl\ql {{New weight, w(2)}}\cell
\row
\trowd\cellx1380\cellx2760\cellx4140\cellx5520\cellx6900
\pard\intbl\ql {1}\cell
\pard\intbl\ql {Male}\cell
\pard\intbl\ql {Over-50}\cell
\pard\intbl\ql {1}\cell
\pard\intbl\ql {{{\field{\*\fldinst{ EQ {1{\f6\u-3916\'B4}4/3= \\F(4,3)}}}{\fldrslt }}}}\cell
\row
\trowd\cellx1380\cellx2760\cellx4140\cellx5520\cellx6900
\pard\intbl\ql {2}\cell
\pard\intbl\ql {Male}\cell
\pard\intbl\ql {Over-50}\cell
\pard\intbl\ql {1}\cell
\pard\intbl\ql {{{\field{\*\fldinst{ EQ {1{\f6\u-3916\'B4}4/3= \\F(4,3)}}}{\fldrslt }}}}\cell
\row
\trowd\cellx1380\cellx2760\cellx4140\cellx5520\cellx6900
\pard\intbl\ql {3}\cell
\pard\intbl\ql {Male}\cell
\pard\intbl\ql {Under-50}\cell
\pard\intbl\ql {1}\cell
\pard\intbl\ql {{{{\b 1}{\f6\'B4}{\b 8}/{\b 2}=4}}}\cell
\row
\trowd\cellx1380\cellx2760\cellx4140\cellx5520\cellx6900
\pard\intbl\ql {4}\cell
\pard\intbl\ql {Female}\cell
\pard\intbl\ql {Over-50}\cell
\pard\intbl\ql {1}\cell
\pard\intbl\ql {{{\field{\*\fldinst{ EQ {1{\f6\u-3916\'B4}4/3= \\F(4,3)}}}{\fldrslt }}}}\cell
\row
\trowd\cellx1380\cellx2760\cellx4140\cellx5520\cellx6900
\pard\intbl\ql {5}\cell
\pard\intbl\ql {Female}\cell
\pard\intbl\ql {Under-50}\cell
\pard\intbl\ql {1}\cell
\pard\intbl\ql {{{1{\f6\'B4}8/2=4}}}\cell
\row
}  \par
}\pard\qj\sl240\slmult1 \sb240 \fi0 After the individual level data have been re-aggregated ({t:m2}), the next stage is to repeat {eq:ipf} for the age constraint to generate a third set of weights, by replacing the {{{\i i}}} in {{\field{\*\fldinst{ EQ {{\i s}{\i T}\\s\\do5({\fs16 {\i i}})}}}{\fldrslt }}} and {{\field{\*\fldinst{ EQ {{\i m}{\i T}({\i n})\\s\\do5({\fs16 {\i i}})}}}{\fldrslt }}} with {{{\i j}}} and incrementing the value of n:\par
{\par\par
\pard\tqc\tx3450\tqr\tx6900\tab {\field{\*\fldinst{ EQ {{\i w}(3)\\s\\do5({\fs16 {\i i}{\i j}})= \\F({\i w}(2)\\s\\do5({\fs16 {\i i}{\i j}}){\f6\u-3916\'B4}{\i s}{\i T}\\s\\do5({\fs16 {\i j}}),{\i m}{\i T}(2)\\s\\do5({\fs16 {\i j}}))}}}{\fldrslt }}\tab{\b0 ({\*\bkmkstart BMeq_ipf2}2{\*\bkmkend BMeq_ipf2})}\par
}\pard\qj\sl240\slmult1 \fi300 To test your understanding of IPF, apply {eq:ipf2} to the information above and that presented in {t:m2}. This should result in the following vector of new weights, for individuals 1 to 5: {\par\par
\pard\tqc\tx3450\tqr\tx6900\tab {\field{\*\fldinst{ EQ {{\i w}(3)=( \\F(6,5)\\, \\F(6,5)\\, \\F(18,5)\\, \\F(3,2)\\, \\F(9,2))}}}{\fldrslt }}\tab{\b0 (3)}\par
}\pard\qj\sl240\slmult1 \fi0 As before, the sum of the weights is equal to the population of the area (12). Notice also that after each iteration the fit between the marginal totals of {{{\i m}}} and {{{\i s}}} improves. The total absolute error (TAE) from {{{\i m}(1)}} to {{{\i m}(2)}} improves from 14 to 6 in {t:m} and {t:m2} above. TAE for {{{\i m}(3)}} (not shown, but calculated by aggregating {{{\i w}(3)}}) improves even more, to 1.3. This number would eventually converge to 0 through subsequent iterations, as there are no empty cells in the input microdataset; a defining feature of IPF.\par
{\pard\qj\sl240\slmult1 \sb240 \fi0  \par
\pard\qc\sl240\slmult1 \fi0 {Table {\*\bkmkstart BMt_m2}7{\*\bkmkend BMt_m2}: The aggregated results of the weighted microdata set after constraining for age ({{{\i m}(2)}}). }{\field{\*\fldinst TC "7 The aggregated results of the weighted microdata set after constraining for age ({{{\i m}(2)}}). " \\f t}{\fldrslt }}\par
{\pard\qc\sl240\slmult1 \fi0 \par
\trowd\cellx1380\cellx2760\clmgf\cellx4140\clmrg\cellx5520\cellx6900
\pard\intbl\qc {Marginal totals}\cell
\pard\intbl\ql {}\cell
\pard\intbl\qc {{{{\i i}}}}\cell
\pard\intbl{}\cell
\pard\intbl\ql {}\cell
\row
\trowd\cellx1380\cellx2760\cellx4140\cellx5520\cellx6900
\pard\intbl\qc {}\cell
\pard\intbl\ql {Age/sex}\cell
\pard\intbl\ql {Male}\cell
\pard\intbl\ql {Female}\cell
\pard\intbl\ql {T}\cell
\row
\trowd\cellx1380\cellx2760\cellx4140\cellx5520\cellx6900
\pard\intbl\qc {{2}{*}{{{{\i j}}}}}\cell
\pard\intbl\ql {Under-50}\cell
\pard\intbl\ql {4}\cell
\pard\intbl\ql {4}\cell
\pard\intbl\ql {8}\cell
\row
\trowd\cellx1380\cellx2760\cellx4140\cellx5520\cellx6900
\pard\intbl\qc {}\cell
\pard\intbl\ql {Over-50}\cell
\pard\intbl\ql {{{\field{\*\fldinst{ EQ { \\F(8,3)}}}{\fldrslt }}}}\cell
\pard\intbl\ql {{{\field{\*\fldinst{ EQ { \\F(4,3)}}}{\fldrslt }}}}\cell
\pard\intbl\ql {4}\cell
\row
\trowd\cellx1380\cellx2760\cellx4140\cellx5520\cellx6900
\pard\intbl\qc {}\cell
\pard\intbl\ql {T}\cell
\pard\intbl\ql {{{\field{\*\fldinst{ EQ {6 \\F(2,3)}}}{\fldrslt }}}}\cell
\pard\intbl\ql {5{{\field{\*\fldinst{ EQ { \\F(1,3)}}}{\fldrslt }}}}\cell
\pard\intbl\ql {12}\cell
\row
}  \par
}\pard\qj\sl240\slmult1 \sb240 \fi0 The above process, when applied to more categories (e.g. socio-economic class) and repeated iteratively until a satisfactory convergence occurs, results in a series of weighted microdatasets, one for each of the small areas being simulated. This allows for the estimation of variables whose values are not known at the local level (e.g. income) ({Ballas et\~al.}, 2005). An issue with the results of IPF (absent from combinatorial optimisation methods), however, is that it results in non-integer weights: fractions of individuals appear in simulated areas. As described in the introduction, this is not ideal for certain applications. Integer weights allow the results of spatial microsimulation to be further processed using dynamic microsimulation and agent based modelling techniques ({Pritchard and Miller}, 2012).\par
\pard\qj\sl240\slmult1 \fi300 Spatial microsimulation can also provide insight into the likely distribution of individual level variables about which only geographically aggregated statistics have been made available. An issue with the results of IPF (absent from combinatorial optimisation methods), however, is that it results in non-integer weights: fractions of individuals appear in simulated areas.\par
\pard\qj\sl240\slmult1 \sb120 \fi0 {\s4\ql\sb240\sa60\keepn\f13\b\fs32 {\*\bkmkstart BMsimplementing}3.1{\*\bkmkend BMsimplementing}  Implementing IPF in R\par
}\pard\qj\sl240\slmult1 \sb60 \fi0 The above example is best undertaken by hand, probably with a pen and paper to gain an understanding of IPF, before the process is automated for larger datasets. This section explains how the IPF algorithm described above is implemented in R, using a slightly more complex example ({Lovelace and Ballas}, 2013).{\up16\chftn}
{\*\footnote \pard\plain\s246\f13\fs20 {\up16\chftn}This tutorial is available from Rpubs, a site dedicated to publishing R analyses that are reproducible. It uses the RMarkdown mark-up language, which enables R code to be run and presented within documents. See http://rpubs.com/RobinLovelace/5089 {\*\bkmkstart BMfnrpub}{\*\bkmkend BMfnrpub} . }
\par
\pard\qj\sl240\slmult1 \sb240 \fi0 {\s3\ql\sb240\sa60\keepn\f13\b\fs32 4  Evaluation techniques\par
}\pard\qj\sl240\slmult1 \sb60 \fi0 To verify the integrity of any model, it is necessary to compare its outputs with empirical observations or prior expectations gleaned from theory. The same principles apply to spatial microsimulation, which can be evaluated using both internal and {\i external} validation methods ({Edwards and Clarke}, 2009). {\i Internal validation} is the process whereby the aggregate-level outputs of spatial microsimulation are compared with the input constraint variables. Internal validation typically tackle such issues as \ldblquote do the simulated populations in each area microdata match the total populations implied by the constrain variables? \rdblquote  and \ldblquote what is the level of correspondence between the cell values of different attributes in the aggregate input data and the aggregated results of spatial microsimulation? \rdblquote  As we shall see below, ideally we would hope for a perfect fit between the input and output datasets during internal evaluation. {\i External validation} is the process whereby the variables that are being estimated are compared to data from another source, external to the estimation process, so the output dataset is compared with another known dataset for those variables.\par
\pard\qj\sl240\slmult1 \fi300 This section outlines the evaluation techniques that are commonly used in the field, with a strong focus on internal validation. The options for external validation are heavily context dependent so must generally be decided on a case-by-case basis, and are mentioned in passing with a focus on general principles rather than specific advice. The methods are presented in ascending order of complexity and roughly descending order of frequency of use, ranging from Pearson\rquote s coefficient of correlation to entropy based measures. Before these methods are described, it is worth stating the purpose of this section is not to find the \lquote best\rquote  evaluation metric: each has advantages and disadvantages, the importance of which will vary depending on the nature of the research. A final point is that the use of a variety of techniques in this paper is of interest in itself. The high degree of correspondence between them (presented in {cresults}), suggests that researchers need only to present one or two metrics (but should perhaps try more, for corroboration) to establish relative levels of goodness of fit between different model configurations.\par
\pard\qj\sl240\slmult1 \sb120 \fi0 {\s4\ql\sb240\sa60\keepn\f13\b\fs32 4.1  Scatter plots and Pearson\rquote s coefficient of correlation\par
}\pard\qj\sl240\slmult1 \sb60 \fi0 A scatter plot of cell counts for each category for the original and simulated variables is a basic but very useful preliminary diagnostic tool in spatial microsimulation ({Ballas et\~al.}, 2005; {Edwards and Clarke}, 2009). In addition marking the points, depending on the variable and category which they represent, can help identify which variables are particularly problematic, aiding the process of improving faulty code (sometimes referred to as \lquote debugging\rquote ).\par
\pard\qj\sl240\slmult1 \fi300 In these scatter plots each data point represents a single zone-category combination (e.g. 16-25 year old female in zone 001), with the x axis value corresponding to the number of individuals of that description in the input constraint table. The y value corresponds to the aggregated count of individuals in the same category in the aggregated (wide) representation of the spatial microdata output from the model. This stage can be conducted either before or after {\i integerisation} (more on this below). As taught in basic statistics courses, the closer the points to the 1:1 (45 degree, assuming the axes have the same scale) line, the better the fit.\par
\pard\qj\sl240\slmult1 \fi300 Pearson\rquote s coefficient of correlation (henceforth Pearson\rquote s {{{\i r}}}) is a quantitative indicator of how much deviation there is from this ideal 1:1 line. It varies from 0 to 1, and in this context reveals how closely the simulated values fit the actual (census) data. An {{{\i r}}} value of 1 represents a perfect fit; an {{{\i r}}} value close to zero suggests no correspondence between then constraints and simulated outputs (i.e. that the model has failed). We would expect to see very high coefficient of determination for internal validation (the constraint) and strong positive correlation between target variables that have been estimated and external datasets (e.g. income).\par
\pard\qj\sl240\slmult1 \sb120 \fi0 {\s4\ql\sb240\sa60\keepn\f13\b\fs32 4.2  Standard error around identity (SEI)\par
}\pard\qj\sl240\slmult1 \sb60 \fi0 here SEI is the standard error around identity, y are the estimated values for each area, y rel are the reliable estimates for each area from a census or other data source and y rel is the mean estimate for all areas where reliable data are available. This estimate has been used in validation by both Ballas and Tanton (see Ballas et al. 2007; Tanton et al. 2011).\par
\pard\qj\sl240\slmult1 \sb120 \fi0 {\s4\ql\sb240\sa60\keepn\f13\b\fs32 4.3  Total Absolute and Standardized Error (TAE and SAE)\par
}\pard\qj\sl240\slmult1 \sb60 \fi0 The SAE addresses this issue by using the population size as the denominator, but generally, authors seem to use total population, rather than the population for that categorization of the variable, which may be deemed to understate the size of the errors. Also, this measure does not provide any information on whether any differences are statistically significant (Edwards and Tanton, 2013).\par
\pard\qj\sl240\slmult1 \sb120 \fi0 {\s4\ql\sb240\sa60\keepn\f13\b\fs32 4.4  Z scores\par
}\pard\qj\sl240\slmult1 \sb60 \fi0 Here, the evaluation mainly takes place at the cell level (for a single constraint in a single area). However, there should also be attention for the overall picture like spatial concentration.\par
\pard\qj\sl240\slmult1 \sb240 \fi0 {\s3\ql\sb240\sa60\keepn\f13\b\fs32 5  Input data\par
}\pard\qj\sl240\slmult1 \sb60 \fi0 Three input datasets form the basis of the scenarios tested in this paper, \lquote simple\rquote , \lquote small-area\rquote  and \lquote sheffield\rquote . Each consists of a set of aggregate constraints and corresponding individual-level survey tables. The latter are anonymous and have been \lquote scrambled\rquote  to enable their publication on the internet. This enables the results to be replicated by others, without breaching the user licenses of the data. To this end, all the input data (and code) used to generate the results reported in the paper are available online on the code-sharing site GitHub. The simplest scenario consists of 6 zones which must be populated by a sample survey dataset of only five individuals, constrained by two variables (age and sex). This scenario is purely hypothetical and is used to represent the IPF procedure and the tests in the simplest possible terms. Its small size allows the entirety of the input data to be viewed in a couple of tables that fit on a single page (see {t1} and {t2}). As with all data used in this paper, these tables can be viewed and downloaded online.\par
{\pard\qj\sl240\slmult1 \sb240 \fi0  \par
\pard\qc\sl240\slmult1 \fi0 {Table {\*\bkmkstart BMt1}8{\*\bkmkend BMt1}: Individual-level data for the simple scenario. The file, \lquote vailable from the GitHub in the folder \lquote {\f16 \field{\*\fldinst{ HYPERLINK "https://github.com/Robinlovelace/IPF-performance-testing/tree/master/input-data/small-area-eg" }{{}}}{\fldrslt{input-data}}}\rquote }{\field{\*\fldinst TC "8 Individual-level data for the simple scenario. The file, \lquote vailable from the GitHub in the folder \lquote {\f16 \field{\*\fldinst{ HYPERLINK "https://github.com/Robinlovelace/IPF-performance-testing/tree/master/input-data/small-area-eg" }{{}}}{\fldrslt{input-data}}}\rquote " \\f t}{\fldrslt }}\par
{{\pard\qc\sl240\slmult1 \fi0 \par
\trowd\cellx2300\cellx4600\cellx6900
\pard\intbl\ql {Id}\cell
\pard\intbl\ql {Age}\cell
\pard\intbl\ql {Sex}\cell
\row
\trowd\cellx2300\cellx4600\cellx6900
\pard\intbl\qr {1}\cell
\pard\intbl\qr {59}\cell
\pard\intbl\ql {m}\cell
\row
\trowd\cellx2300\cellx4600\cellx6900
\pard\intbl\qr {2}\cell
\pard\intbl\qr {54}\cell
\pard\intbl\ql {m}\cell
\row
\trowd\cellx2300\cellx4600\cellx6900
\pard\intbl\qr {3}\cell
\pard\intbl\qr {35}\cell
\pard\intbl\ql {m}\cell
\row
\trowd\cellx2300\cellx4600\cellx6900
\pard\intbl\qr {4}\cell
\pard\intbl\qr {73}\cell
\pard\intbl\ql {f}\cell
\row
\trowd\cellx2300\cellx4600\cellx6900
\pard\intbl\qr {5}\cell
\pard\intbl\qr {49}\cell
\pard\intbl\ql {f}\cell
\row
} \par
}}{\pard\qj\sl240\slmult1 \sb480 \fi0  \par
\pard\qc\sl240\slmult1 \fi0 {Table {\*\bkmkstart BMt2}9{\*\bkmkend BMt2}: Geographically aggregated constraint variables for the simple scenario, also available online}{\field{\*\fldinst TC "9 Geographically aggregated constraint variables for the simple scenario, also available online" \\f t}{\fldrslt }}\par
{{\pard\qc\sl240\slmult1 \fi0 \par
\trowd\cellx1380\clmgf\cellx2760\clmrg\cellx4140\clmgf\cellx5520\clmrg\cellx6900
\pard\intbl\ql {}\cell
\pard\intbl\qc {Age constraint}\cell
\pard\intbl{}\cell
\pard\intbl\qc {Sex constraint}\cell
\pard\intbl{}\cell
\row
\trowd\cellx1380\cellx2760\cellx4140\cellx5520\cellx6900
\pard\intbl\ql {Zone}\cell
\pard\intbl\qc {16\endash 49}\cell
\pard\intbl\qc {50+}\cell
\pard\intbl\qc {m}\cell
\pard\intbl\qc {f}\cell
\row
\trowd\cellx1380\cellx2760\cellx4140\cellx5520\cellx6900
\pard\intbl\qr {1}\cell
\pard\intbl\qr {8}\cell
\pard\intbl\qr {4}\cell
\pard\intbl\qr {6}\cell
\pard\intbl\qr {6}\cell
\row
\trowd\cellx1380\cellx2760\cellx4140\cellx5520\cellx6900
\pard\intbl\qr {2}\cell
\pard\intbl\qr {2}\cell
\pard\intbl\qr {8}\cell
\pard\intbl\qr {4}\cell
\pard\intbl\qr {6}\cell
\row
\trowd\cellx1380\cellx2760\cellx4140\cellx5520\cellx6900
\pard\intbl\qr {3}\cell
\pard\intbl\qr {7}\cell
\pard\intbl\qr {4}\cell
\pard\intbl\qr {3}\cell
\pard\intbl\qr {8}\cell
\row
\trowd\cellx1380\cellx2760\cellx4140\cellx5520\cellx6900
\pard\intbl\qr {4}\cell
\pard\intbl\qr {5}\cell
\pard\intbl\qr {4}\cell
\pard\intbl\qr {7}\cell
\pard\intbl\qr {2}\cell
\row
\trowd\cellx1380\cellx2760\cellx4140\cellx5520\cellx6900
\pard\intbl\qr {5}\cell
\pard\intbl\qr {7}\cell
\pard\intbl\qr {3}\cell
\pard\intbl\qr {6}\cell
\pard\intbl\qr {4}\cell
\row
\trowd\cellx1380\cellx2760\cellx4140\cellx5520\cellx6900
\pard\intbl\qr {6}\cell
\pard\intbl\qr {5}\cell
\pard\intbl\qr {3}\cell
\pard\intbl\qr {2}\cell
\pard\intbl\qr {6}\cell
\row
} \par
}}\pard\qj\sl240\slmult1 \sb240 \fi0 The next smallest input dataset, and the most commonly used scenario in the paper, is \lquote small-area\rquote . The area constraints consist of 24 Output Areas (the smallest administrative geographical unit in the UK), with an average population of 184 people aged over 16. Three files describe the number of hours worked, the marital status and the tenancy of these individuals (although tenancy in fact counts houses, not people): the files can be accessed from the hyperlinks embedded in digital versions of the previous sentence. A sample of these constraint variables is presented in {t3} below. {\par
\pard\qj\sl240\slmult1 \sb240 \fi0  \par
\pard\qc\sl240\slmult1 \fi0 {Table {\*\bkmkstart BMt3}10{\*\bkmkend BMt3}: Sample of constraint variables from the first 5 rows of the small-area-eg input dataset.}{\field{\*\fldinst TC "10 Sample of constraint variables from the first 5 rows of the small-area-eg input dataset." \\f t}{\fldrslt }}\par
{{\pard\qc\sl240\slmult1 \fi0 \par
} \par
}}\pard\qj\sl240\slmult1 \sb240 \fi0 The individual-level table that compliments these geographically aggregated count constraints is taken from Understanding Society wave 1. These have been randomised to ensure anonymity but they are still roughly representative of real data. The table consists of 1768 rows of data and is stored in R\u8217?s own space-efficient filetype (see \ldblquote ind.RData\rdblquote , which must be opened in R to be viewed properly). As shown in {t4} below, this consists of the same 3 constraint variables as provided in {t3} but at aggregate level, in addition to one \lquote target variable\rquote : monthly pre-tax income in pounds. \par
{\pard\qj\sl240\slmult1 \sb240 \fi0  \par
\pard\qc\sl240\slmult1 \fi0 {Table {\*\bkmkstart BMt4}11{\*\bkmkend BMt4}: Randomly selected sample of 5 individuals taken from the individual-level dataset.}{\field{\*\fldinst TC "11 Randomly selected sample of 5 individuals taken from the individual-level dataset." \\f t}{\fldrslt }}\par
{{\pard\qc\sl240\slmult1 \fi0 \par
} \par
}}\pard\qj\sl240\slmult1 \sb240 \fi0 ... More here on loading-up this data.\par
\pard\qj\sl240\slmult1 \sb240 \fi0 {\s3\ql\sb240\sa60\keepn\f13\b\fs32 6  Method: model experiments\par
}\pard\qj\sl240\slmult1 \sb180 \fi0 {\s4\ql\sb240\sa60\keepn\f13\b\fs32 6.1  Baseline scenarios\par
}\pard\qj\sl240\slmult1 \sb60 \fi0 In order to perform a wide range of model experiments, in which only one factor is altered at a time, it was necessary to clearly define baseline scenarios. These are model runs with sensible defaults, which can be referred back to as a reference point and re-used at any point in the future. The baseline \u8216?simple\u8217? scenario consists of 3 iterations, leading to a total of 6 constraint-iteration permutations. The results of simplest baseline scenario are shown in {tblresults1}. The results show that the model fit improves after every iteration and every constraint in every measure of model fit (except \lquote p5\rquote , which reaches zero in the second iteration) \emdash  {{{\i p}{\i c}{\i o}{\i r}}} continues to improve, even though the printed value, to 6 decimal places, is indistinguishable from 1 after two complete iterations.\par
{\pard\qj\sl240\slmult1 \sb240 \fi0  \par
\pard\qc\sl240\slmult1 \fi0 {Table {\*\bkmkstart BMtblresults1}12{\*\bkmkend BMtblresults1}: Results for the baseline \lquote simple\rquote  scenario. Generated through by the \u8216?analysis\u8217? script, and available as a .csv file online.}{\field{\*\fldinst TC "12 Results for the baseline \lquote simple\rquote  scenario. Generated through by the \u8216?analysis\u8217? script, and available as a .csv file online." \\f t}{\fldrslt }}\par
{{\pard\qc\sl240\slmult1 \fi0 \par
} \par
}}\pard\qj\sl240\slmult1 \sb240 \fi0 The baseline \lquote small-area\rquote  scenario consists of three iterations of IPF, in which all three constraints were used. The results for all 9 constraint-iteration permutations of this baseline scenario are illustrated in {fipfinac} and in the online \lquote measures\rquote  table. These results show that IPF successfully brings the simulated cell counts in-line with the census after each constraint is applied and that the fit improves with each iteration (only two iterations are shown here, as the fit improves very little beyond two, and to avoid clutter).\par
{\pard\qj\sl240\slmult1 \sb240 \fi300 {\par
\pard\qc\sl240\slmult1 \fi0  \par
}\pard\qc\sl240\slmult1 \fi0 {Figure {\*\bkmkstart BMfipfinac}2{\*\bkmkend BMfipfinac}: IPF in action: simulated vs census zone counts for the small-area baseline scenario after each constraint (columns) and iteration (rows).}{\field{\*\fldinst TC "2 IPF in action: simulated vs census zone counts for the small-area baseline scenario after each constraint (columns) and iteration (rows)." \\f f}{\fldrslt }}\par
}\pard\qj\sl240\slmult1 \sb240 \fi0 The baseline \lquote Sheffield\rquote  scenario consists of the same basic set-up, but with 4 constraints. As before, the results show convergence towards better model fit, although the fit does not always improve from one constraint to the next (see the online \lquote measures\rquote  table). \par
\pard\qj\sl240\slmult1 \sb120 \fi0 {\s4\ql\sb240\sa60\keepn\f13\b\fs32 6.2  Constraints and iterations\par
}\pard\qj\sl240\slmult1 \sb60 \fi0 These were the simplest model experiments, requiring only the reporting of iterations that had already taken place, and re-arrangement of the IPF code such that constraints were applied in a different order than before. The re-ordered code for the \lquote small-area\rquote  scenario, for example can be seen in the script \lquote etsim-reordered\rquote  online.\par
\pard\qj\sl240\slmult1 \sb120 \fi0 {\s4\ql\sb240\sa60\keepn\f13\b\fs32 6.3  Initial weights\par
}\pard\qj\sl240\slmult1 \sb60 \fi0 The impact of initial weights was tested in two ways: first, the impact of changing a sample of one or more initial weight values by a set amount was explored. Second, the impact of of the size of the initial weights was tested, by running the same model experiment several times, but with incrementally larger initial weights applied to a pre-determined set of individuals.\par
\pard\qj\sl240\slmult1 \sb120 \fi0 {\s4\ql\sb240\sa60\keepn\f13\b\fs32 6.4  Empty cells\par
}\pard\qj\sl240\slmult1 \sb60 \fi0 Empty cells refer to cross-tabulations of individual-level attributes that are not represented by any single individual in the survey input data. An example of this would be if no female in the 16 to 49 year age bracket were present in {t1}. The method used to find-out if empty cells exist is to first select only individuals with unique characteristics (in the narrow terms of the constraint variables \emdash  of course every survey individual is unique). The column totals of the categorical (binary, 0 or 1) form of this dataset are compared: any categories with fewer than expected totals have missing cells. \par
\pard\qj\sl240\slmult1 \fi300 Once the presence of empty cells is determined in the baseline scenarios, the next stage is to add or subtract empty cells by adding or subtracting individuals to the input data. After these changes were made, the baseline scenarios were run as before.\par
\pard\qj\sl240\slmult1 \fi300 In the \u8216?simple\u8217? scenario, this simply involves removing a single individual from the input data, which equates to deleting a single line of code (see \lquote etsim-empty\rquote ). The question of which unique individual to remove is solved by random sampling. \par
\pard\qj\sl240\slmult1 \sb120 \fi0 {\s4\ql\sb240\sa60\keepn\f13\b\fs32 6.5  Integerisation\par
}\pard\qj\sl240\slmult1 \sb60 \fi0 This was the next variable that was altered, following . In the simplest scenario, the initial weight of a single individual was altered repeatedly, in a controlled manner. The code enabling this model experiment is contained in the folder \lquote small-area-weights\rquote  (see \lquote etsim.R\rquote ). The number of different initial weights can be controlled by the parameter \lquote num.ws\rquote  which is set to 5 as an arbitrary default. Initial weights are set to k, a vector of length \lquote num.ws\rquote  which are by default set as a function of \lquote u\rquote  which is in term defined as the sequence 1:num.ws:\par
{\pard\qj\sl240\slmult1 \fi0 \qc [Sorry. Ignored {\plain\f16\\begin\{lstlisting\} ... \\end\{lstlisting\}}]\par
}\pard\qj\sl240\slmult1 \fi300 In this case the resultant weights are set to 0.7, 0.9, 1.1, 1.3 and 1.5 for each model experiment. For factors of one million, for example, the above would be replaced by ! k <- u * 10\\s\\up5({\fs16 6})yrm! . To observe the impacts of altering the weights in this way the usual tests of model fit were conducted. In addition, the capacity of initial weights to influence an individual\rquote s final weight/probability of selection was tested by tracing its weight into the future after each successive constraint and iteration. This enabled plotting original vs simulated weights under a range of conditions ({cresults}).\par
\pard\qj\sl240\slmult1 \sb240 \fi0 {\s3\ql\sb240\sa60\keepn\f13\b\fs32 {\*\bkmkstart BMcresults}7{\*\bkmkend BMcresults}  Results\par
}\pard\qj\sl240\slmult1 \sb180 \fi0 {\s4\ql\sb240\sa60\keepn\f13\b\fs32 7.1  Baseline scenarios\par
}\pard\qj\sl240\slmult1 \sb60 \fi0 As expected from {fipfinac} above, the correlation of the baseline scenario improves over time, with each constraint and from one iteration to the next. Through the course of the first iteration, the correlation improves from 0.67 (the correlation between the frequencies of variables in the survey dataset and their frequencies in the census dataset, for each zone) to 0.9981. As illustrated in {fnconscor}, the marginal improvement reduces from one iteration to the next: at the end of iteration 2, the correlation has improved to 0.999978. \par
{\pard\qj\sl240\slmult1 \sb240 \fi300 {\par
\pard\qc\sl240\slmult1 \fi0  \par
}\pard\qc\sl240\slmult1 \fi0 {Figure {\*\bkmkstart BMfnconscor}3{\*\bkmkend BMfnconscor}: Improvement in goodness of fit with additional constraints and iterations, as illustrated by {{{\i r}}} values.}{\field{\*\fldinst TC "3 Improvement in goodness of fit with additional constraints and iterations, as illustrated by {{{\i r}}} values." \\f f}{\fldrslt }}\par
}\pard\qj\sl240\slmult1 \sb360 \fi0 {\s4\ql\sb240\sa60\keepn\f13\b\fs32 7.2  Constraints and iterations\par
}\pard\qj\sl240\slmult1 \sb60 \fi0 As illustrated above, the number of iterations required to reach a very close fit between the census and simulated data is very low, with rapid reductions in the marginal accuracy return on additional computing power. After four iterations, the result in R is indistinguishable from 1, with its default accuracy of 7 decimal places. The decay in the rate of improvement with additional iterations and constraints was found to super-exponential. \par
\pard\qj\sl240\slmult1 \sb120 \fi0 {\s4\ql\sb240\sa60\keepn\f13\b\fs32 7.3  Initial weights\par
}\pard\qj\sl240\slmult1 \sb60 \fi0 It was found that initial weights had little impact on the overall simulation. Taking the simplest case, a random individual (id = 228) was selected from the \lquote small area\rquote  data and his/her initial weight was set to 2 (instead of the default of 1). The impact of this change on the individual\rquote s simulated weight decayed rapidly, tending to zero after only 5 iterations in the small-area scenario. It was found that altered initial weights affect the simulated weights of all other individuals; this is illustrated in {ficweight}, which shows the impact on individual 228 and a randomly selected individual whose initial weight was not altered, for all areas.\par
{\pard\qj\sl240\slmult1 \sb240 \fi300 {\par
\pard\qc\sl240\slmult1 \fi0  \par
}\pard\qc\sl240\slmult1 \fi0 {Figure {\*\bkmkstart BMficweight}4{\*\bkmkend BMficweight}: The impact of changing the initial weight of individual 228 on the simulated weights of two individuals after 5 iterations. Each of the 24 coloured lines represents a single zone.}{\field{\*\fldinst TC "4 The impact of changing the initial weight of individual 228 on the simulated weights of two individuals after 5 iterations. Each of the 24 coloured lines represents a single zone." \\f f}{\fldrslt }}\par
}\pard\qj\sl240\slmult1 \sb240 \fi0 {ficweight} shows that changing initial weights for individuals has a limited impact on the results that tends to zero from one iteration to the next. After iteration one the impact of a 100% increase in the initial weight of individual 228 had reduced to 0.3%; after 3 iterations the impact was negligible. The same pattern can be observed in the control individual 570, although the impact is smaller and in the reverse direction. The same pattern can be observed for other individuals, by altering the \lquote analysis.min\rquote .\par
\pard\qj\sl240\slmult1 \fi300 To analyse the impacts of changing the initial weights of multiple individuals, the same experiment was conducted, but this time the initial weights were applied to the first five individuals. The results are illustrated in {finweight}, which shows the relationship between initial and final weights for the first two individuals and another two individuals (randomly selected to show the impact of altering weights on other individual weights). \par
{\pard\qj\sl240\slmult1 \sb240 \fi300 {\par
\pard\qc\sl240\slmult1 \fi0  \par
}\pard\qc\sl240\slmult1 \fi0 {Figure {\*\bkmkstart BMfinweight}5{\*\bkmkend BMfinweight}: Initial vs simulated weight of four individuals for a single area (zone 1).}{\field{\*\fldinst TC "5 Initial vs simulated weight of four individuals for a single area (zone 1)." \\f f}{\fldrslt }}\par
}\pard\qj\sl240\slmult1 \sb240 \fi0 {finweight} shows that the vast majority of the impact of altered starting weights occurs in iteration-constraint combinations 1.1 and 1.2, before a complete iteration has even occurred. After that, the initial weights continue to have an influence, of a magnitude that cannot be seen. For individual 1, the impact of a 53% difference in initial weights (from 0.7 to 1.5) shrinks to 2.0% by iteration 1.3 and to 1.1% by iteration 2.3. \par
\pard\qj\sl240\slmult1 \fi300 These results suggest that initial weights have a limited impact on the results of IPF, that declines rapidly with each iteration. \par
\pard\qj\sl240\slmult1 \sb120 \fi0 {\s4\ql\sb240\sa60\keepn\f13\b\fs32 7.4  Empty cells\par
}\pard\qj\sl240\slmult1 \sb180 \fi0 {\s4\ql\sb240\sa60\keepn\f13\b\fs32 7.5  Integerisation\par
}\pard\qj\sl240\slmult1 \sb300 \fi0 {\s3\ql\sb240\sa60\keepn\f13\b\fs32 8  Conclusions\par
}{\pard\qj\sl240\slmult1 \sb180 \fi0 {\plain\b\fs32 References}\par
\pard\qj\sl240\slmult1 \sb60 \li450\fi-450 Bacharach, M., 1970. {Biproportional matrices & input-output change}. volume\~16. Cambridge University Press, Cambridge. \par
\pard\qj\sl240\slmult1 \li450\fi-450 Ballas, D., Clarke, G., Dorling, D., Eyre, H., Thomas, B., Rossiter, D., 2005. {SimBritain: a spatial microsimulation approach to population dynamics}. Population, Space and Place 11, 13\endash 34. \par
\pard\qj\sl240\slmult1 \li450\fi-450 Ballas, D., Clarke, G., Hynes, S., Lennon, J., Morrissey, K., Donoghue, C.O., 2013. {A Review of Microsimulation for Policy Analysis}, in: O\rquote Donoghue, C., Ballas, D., Clarke, G., Hynes, S., Morrissey, K. (Eds.), Spatial Microsimulation for Rural Policy Analysis. Springer Berlin Heidelberg, Berlin, Heidelberg. Advances in Spatial Science. chapter\~3, pp. 35\endash 54. \par
\pard\qj\sl240\slmult1 \li450\fi-450 Ballas, D., Clarke, G.P., 2003. {Microsimulation and regional science: 30 years of spatial microsimulation of populations}, in: 50th Annual North American Meeting of the Regional Science Association, Philadelphia, USA, pp. 19\endash 22. \par
\pard\qj\sl240\slmult1 \li450\fi-450 Ballas, D., Clarke, G.P., Dewhurst, J., 2006. {Modelling the Socio-economic Impacts of Major Job Loss or Gain at the Local Level: a Spatial Microsimulation Framework}. Spatial Economic Analysis 1, 127\endash 146. \par
\pard\qj\sl240\slmult1 \li450\fi-450 Clarke, G., Harding, A., 2013. {Conclusions and Future Research Directions}, in: Tanton, R., Edwards, K. (Eds.), Spatial Microsimulation: A Reference Guide for Users. Springer, Berlin, Heidelberg. chapter\~16, pp. 259\endash 273. \par
\pard\qj\sl240\slmult1 \li450\fi-450 Clarke, M., Holm, E., 1987. {Microsimulation methods in spatial analysis and planning}. Geografiska Annaler. Series B. Human Geography 69, 145\endash 164. \par
\pard\qj\sl240\slmult1 \li450\fi-450 Cullinan, J., 2010. {Developing a Continuous Space Representation of a Simulated Population}. Spatial Economic Analysis 5, 317\endash 338. \par
\pard\qj\sl240\slmult1 \li450\fi-450 Deming, W., 1940. {On a least squares adjustment of a sampled frequency table when the expected marginal totals are known}. The Annals of Mathematical Statistics . \par
\pard\qj\sl240\slmult1 \li450\fi-450 Edwards, K.L., Clarke, G.P., 2009. {The design and validation of a spatial microsimulation model of obesogenic environments for children in Leeds, UK: SimObesity.} Social science & medicine 69, 1127\endash 34. \par
\pard\qj\sl240\slmult1 \li450\fi-450 Harland, K., Heppenstall, A., Smith, D., Birkin, M., 2012. {Creating Realistic Synthetic Populations at Varying Spatial Scales: A Comparative Critique of Population Synthesis Techniques}. Journal of Artificial Societies and Social Simulation 15, 1. \par
\pard\qj\sl240\slmult1 \li450\fi-450 Hermes, K., Poulsen, M., 2012. {A review of current methods to generate synthetic spatial microdata using reweighting and future directions}. Computers, Environment and Urban Systems 36, 281\endash 290. \par
\pard\qj\sl240\slmult1 \li450\fi-450 Jirou\u353sek, R., Preu\u269cil, S., 1995. {On the effective implementation of the iterative proportional fitting procedure}. Computational Statistics & Data Analysis 19, 177\endash 189. \par
\pard\qj\sl240\slmult1 \li450\fi-450 Johnston, R.J., 1985. {The geography of English politics: the 1983 general election}. Croom Helm London. \par
\pard\qj\sl240\slmult1 \li450\fi-450 Johnston, R.J., Pattie, C.J., 1993. {Entropy-Maximizing and the Iterative Proportional Fitting Procedure}. The Professional Geographer 45, 317\endash 322. \par
\pard\qj\sl240\slmult1 \li450\fi-450 Lahr, M., de\~Mesnard, L., 2004. {Biproportional Techniques in Input-Output Analysis: Table Updating and Structural Analysis}. Economic Systems Research 16, 115\endash 134. \par
\pard\qj\sl240\slmult1 \li450\fi-450 Lee, A., 2009. {Generating Synthetic Microdata from Published Marginal Tables and Confidentialised Files}. Technical Report. Statistics New Zealand. Wellington. \par
\pard\qj\sl240\slmult1 \li450\fi-450 Lovelace, R., Ballas, D., 2013. {\u8216?Truncate, replicate, sample\u8217?: A method for creating integer weights for spatial microsimulation}. Computers, Environment and Urban Systems 41, 1\endash 11. \par
\pard\qj\sl240\slmult1 \li450\fi-450 Lovelace, R., Ballas, D., Watson, M., 2014. {A spatial microsimulation approach for the analysis of commuter patterns: from individual to regional levels}. Journal of Transport Geography 34, 282\endash 296. \par
\pard\qj\sl240\slmult1 \li450\fi-450 McFadden, D., Heiss, F., Jun, B.h., Winter, J., 2006. {On testing for independence in weighted contingency tables}. Medium for Econometric Applications 14, 11\endash 18. \par
\pard\qj\sl240\slmult1 \li450\fi-450 Morrissey, K., O\rquote donoghue, C., Farrell, N., 2013. {The Local Impact of the Marine Sector in Ireland: A Spatial Microsimulation Analysis}. Spatial Economic Analysis 00, 1\endash 20. \par
\pard\qj\sl240\slmult1 \li450\fi-450 Norman, P., 1999. {Putting Iterative Proportional Fitting (IPF) on the Researcher\u8217?s Desk}. Technical Report October. School of Geography, University of Leeds. \par
\pard\qj\sl240\slmult1 \li450\fi-450 Openshaw, S., 1984. {Ecological fallacies and the analysis of areal census data.} Environment & planning A 16, 17\endash 31. \par
\pard\qj\sl240\slmult1 \li450\fi-450 Pritchard, D.R., Miller, E.J., 2012. {Advances in population synthesis: fitting many attributes per agent and fitting to household and person margins simultaneously}. Transportation 39, 685\endash 704. \par
\pard\qj\sl240\slmult1 \li450\fi-450 Rich, J., Mulalic, I., 2012. {Generating synthetic baseline populations from register data}. Transportation Research Part A: Policy and Practice 46, 467\endash 479. \par
\pard\qj\sl240\slmult1 \li450\fi-450 Simpson, L., Tranmer, M., 2005. {Combining sample and census data in small area estimates: iterative proportional fitting with standard software}. The Professional Geographer 57, 222\endash 234. \par
\pard\qj\sl240\slmult1 \li450\fi-450 Smith, D.M., Clarke, G.P., Harland, K., 2009. {Improving the synthetic data generation process in spatial microsimulation models}. Environment and Planning A 41, 1251\endash 1268. \par
\pard\qj\sl240\slmult1 \li450\fi-450 Tanton, R., Edwards, K., 2013. {Spatial Microsimulation: A Reference Guide for Users}. Springer. \par
\pard\qj\sl240\slmult1 \li450\fi-450 Teh, Y.W., Welling, M., 2003. {On improving the efficiency of the iterative proportional fitting procedure}, in: Proceedings of the International Workshop on Artificial Intelligence and Statistics. \par
\pard\qj\sl240\slmult1 \li450\fi-450 Tomintz, M.N.M., Clarke, G.P., Rigby, J.E.J., 2008. {The geography of smoking in Leeds: estimating individual smoking rates and the implications for the location of stop smoking services}. Area 40, 341\endash 353. \par
\pard\qj\sl240\slmult1 \li450\fi-450 {Van Buuren}, S., 2012. {Flexible imputation of missing data}. CRC press. \par
\pard\qj\sl240\slmult1 \li450\fi-450 Whitworth, A., 2012. {Local Inequality and Crime: Exploring how Variation in the Scale of Inequality Measures Affects Relationships between Inequality and Crime}. Urban Studies . \par
\pard\qj\sl240\slmult1 \li450\fi-450 Williamson, P., 2007. {CO Instruction Manual: Working Paper 2007/1 (v. 07.06.25)}. Technical Report June. University of Liverpool.\par
}}}
